#include <stdio.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <unistd.h>

int main() {
    pid_t child_pid;
    int   status;

    for (int i = 0; i < 5; ++i) {
        child_pid = fork();

        if (child_pid < 0) {
            perror("fork");
            exit(EXIT_FAILURE);

        } else if (child_pid == 0) {
            printf(
                "Je suis le processus fils %d(PID : %d , PPID: %d)\n", i + 1, getpid(), getppid());
            sleep(2);
            sleep(i + 1);
            exit(i + 1);
        }
    }
    while ((child_pid = wait(&status)) > 0) {
        if (WIFEXITED(status)) {
            printf("Le processus fils %d (PID: %d) s'est termine avec le code de "
                   "sortie : %d\n",
                   child_pid,
                   child_pid,
                   WEXITSTATUS(status));

        } else if (WIFSIGNALED(status)) {
            printf("le processus fils %d (PID: %d) a ete tue par un signal : %d \n",
                   child_pid,
                   child_pid,
                   WTERMSIG(status));
        }
    }
    return 0;
}
